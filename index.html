<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>çµæ¢å®šä»·åˆ†æå·¥å…·</title>
    <style>
        :root {
            --primary: #2563eb;
            --primary-light: #3b82f6;
            --success: #10b981;
            --warning: #f59e0b;
            --danger: #ef4444;
            --light: #f8fafc;
            --dark: #1e293b;
            --border: #e2e8f0;
        }
        
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', 'Microsoft YaHei', sans-serif;
        }
        
        body {
            background: linear-gradient(135deg, #f1f5f9 0%, #e2e8f0 100%);
            min-height: 100vh;
            padding: 20px;
        }
        
        .container {
            max-width: 1800px;
            margin: 0 auto;
        }
        
        /* å¤´éƒ¨ */
        .header {
            background: white;
            border-radius: 16px;
            padding: 24px 32px;
            margin-bottom: 24px;
            box-shadow: 0 4px 20px rgba(0, 0, 0, 0.08);
            border: 1px solid var(--border);
        }
        
        .logo-area {
            display: flex;
            align-items: center;
            gap: 16px;
            margin-bottom: 8px;
        }
        
        .logo {
            font-size: 32px;
            color: var(--primary);
        }
        
        .title {
            color: var(--dark);
            font-size: 24px;
            font-weight: 700;
        }
        
        .subtitle {
            color: #64748b;
            font-size: 14px;
        }
        
        /* æˆæœ¬å‚æ•°é¢æ¿ */
        .cost-panel {
            background: white;
            border-radius: 16px;
            padding: 24px;
            box-shadow: 0 4px 20px rgba(0, 0, 0, 0.08);
            border: 1px solid var(--border);
            margin-bottom: 24px;
        }
        
        .section-title {
            color: var(--dark);
            font-size: 18px;
            font-weight: 600;
            margin-bottom: 16px;
            padding-bottom: 10px;
            border-bottom: 2px solid var(--primary);
            display: flex;
            align-items: center;
            gap: 8px;
        }
        
        .input-group {
            margin-bottom: 20px;
        }
        
        .input-label {
            display: block;
            color: #475569;
            font-weight: 500;
            margin-bottom: 8px;
            font-size: 14px;
        }
        
        .input-wrapper {
            position: relative;
        }
        
        .input-wrapper input {
            width: 100%;
            padding: 10px 36px 10px 12px;
            border: 2px solid var(--border);
            border-radius: 8px;
            font-size: 14px;
            transition: all 0.2s;
            background: white;
        }
        
        .input-wrapper input:focus {
            outline: none;
            border-color: var(--primary);
            box-shadow: 0 0 0 3px rgba(37, 99, 235, 0.1);
        }
        
        .currency {
            position: absolute;
            right: 12px;
            top: 50%;
            transform: translateY(-50%);
            color: #94a3b8;
            font-weight: 500;
        }
        
        .input-tip {
            color: #94a3b8;
            font-size: 12px;
            margin-top: 6px;
        }
        
        /* å‚æ•°ç½‘æ ¼ */
        .params-grid {
            display: grid;
            grid-template-columns: repeat(4, 1fr);
            gap: 16px;
        }
        
        @media (max-width: 1200px) {
            .params-grid {
                grid-template-columns: repeat(2, 1fr);
            }
        }
        
        @media (max-width: 768px) {
            .params-grid {
                grid-template-columns: 1fr;
            }
        }
        
        /* SKUç®¡ç† */
        .sku-management {
            background: white;
            border-radius: 16px;
            padding: 24px;
            box-shadow: 0 4px 20px rgba(0, 0, 0, 0.08);
            border: 1px solid var(--border);
            margin-bottom: 24px;
        }
        
        .sku-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
        }
        
        .sku-controls {
            display: flex;
            gap: 12px;
        }
        
        .sku-table-container {
            overflow-x: auto;
            border-radius: 8px;
            border: 1px solid var(--border);
            margin-bottom: 20px;
        }
        
        .sku-table {
            width: 100%;
            border-collapse: collapse;
            min-width: 1300px;
        }
        
        .sku-table th {
            background: #f1f5f9;
            padding: 12px 16px;
            text-align: left;
            font-weight: 600;
            color: var(--dark);
            font-size: 13px;
            border-bottom: 1px solid var(--border);
        }
        
        .sku-table td {
            padding: 10px 16px;
            border-bottom: 1px solid var(--border);
            color: #475569;
            font-size: 13px;
        }
        
        .sku-table tr:hover {
            background: #f8fafc;
        }
        
        .sku-table input {
            width: 100%;
            padding: 8px 10px;
            border: 1px solid var(--border);
            border-radius: 6px;
            font-size: 13px;
            transition: all 0.2s;
        }
        
        .sku-table input:focus {
            outline: none;
            border-color: var(--primary);
            box-shadow: 0 0 0 2px rgba(37, 99, 235, 0.1);
        }
        
        .sku-table input:focus + .enter-hint {
            opacity: 1;
        }
        
        .sku-actions {
            display: flex;
            gap: 6px;
        }
        
        .sku-btn {
            padding: 4px 8px;
            border: none;
            border-radius: 4px;
            font-size: 12px;
            font-weight: 500;
            cursor: pointer;
            transition: all 0.2s;
        }
        
        .sku-btn.add {
            background: var(--primary);
            color: white;
        }
        
        .sku-btn.remove {
            background: #fee2e2;
            color: #991b1b;
        }
        
        .sku-btn.calc {
            background: var(--success);
            color: white;
        }
        
        /* æŠ˜æ‰£ç±»å‹åˆ‡æ¢ */
        .discount-type {
            display: flex;
            background: #e2e8f0;
            border-radius: 6px;
            padding: 4px;
            margin-bottom: 8px;
        }
        
        .type-btn {
            flex: 1;
            padding: 4px 6px;
            text-align: center;
            font-size: 11px;
            font-weight: 500;
            color: #64748b;
            background: transparent;
            border: none;
            border-radius: 4px;
            cursor: pointer;
        }
        
        .type-btn.active {
            background: white;
            color: var(--primary);
            box-shadow: 0 1px 3px rgba(0, 0, 0, 0.1);
        }
        
        /* æŠ˜æ‰£é‡‘é¢é¢„è§ˆ */
        .discount-preview {
            display: flex;
            flex-direction: column;
            gap: 4px;
        }
        
        .discount-preview-row {
            display: flex;
            justify-content: space-between;
            align-items: center;
            font-size: 11px;
        }
        
        .discount-preview-label {
            color: #64748b;
        }
        
        .discount-preview-value {
            font-weight: 600;
        }
        
        .discount-preview-value.primary {
            color: var(--primary);
        }
        
        .discount-preview-value.warning {
            color: var(--warning);
        }
        
        .discount-preview-value.danger {
            color: var(--danger);
        }
        
        .discount-preview-total {
            border-top: 1px solid var(--border);
            padding-top: 4px;
            margin-top: 2px;
            font-weight: 600;
            font-size: 12px;
            color: var(--dark);
        }
        
        /* åˆ©æ¶¦åˆ†æ */
        .profit-analysis {
            background: white;
            border-radius: 16px;
            padding: 24px;
            box-shadow: 0 4px 20px rgba(0, 0, 0, 0.08);
            border: 1px solid var(--border);
        }
        
        .profit-summary {
            display: grid;
            grid-template-columns: repeat(5, 1fr);
            gap: 12px;
            margin-bottom: 24px;
        }
        
        @media (max-width: 1400px) {
            .profit-summary {
                grid-template-columns: repeat(3, 1fr);
            }
        }
        
        @media (max-width: 768px) {
            .profit-summary {
                grid-template-columns: repeat(2, 1fr);
            }
        }
        
        @media (max-width: 480px) {
            .profit-summary {
                grid-template-columns: 1fr;
            }
        }
        
        .profit-card {
            padding: 16px;
            border-radius: 8px;
            text-align: center;
            border: 2px solid var(--border);
            transition: all 0.2s;
        }
        
        .profit-card:hover {
            transform: translateY(-4px);
            box-shadow: 0 8px 25px rgba(0, 0, 0, 0.1);
        }
        
        .profit-card.primary {
            border-color: var(--primary);
            background: linear-gradient(135deg, #eff6ff 0%, #dbeafe 100%);
        }
        
        .profit-card.success {
            border-color: var(--success);
            background: linear-gradient(135deg, #f0fdf4 0%, #dcfce7 100%);
        }
        
        .profit-card.warning {
            border-color: var(--warning);
            background: linear-gradient(135deg, #fffbeb 0%, #fef3c7 100%);
        }
        
        .profit-card.danger {
            border-color: var(--danger);
            background: linear-gradient(135deg, #fef2f2 0%, #fee2e2 100%);
        }
        
        .profit-card.info {
            border-color: #8b5cf6;
            background: linear-gradient(135deg, #f5f3ff 0%, #ede9fe 100%);
        }
        
        .profit-label {
            font-size: 12px;
            color: #64748b;
            margin-bottom: 8px;
        }
        
        .profit-value {
            font-size: 20px;
            font-weight: 700;
            color: var(--dark);
        }
        
        .profit-value.success {
            color: var(--success);
        }
        
        .profit-value.warning {
            color: var(--warning);
        }
        
        .profit-value.danger {
            color: var(--danger);
        }
        
        .profit-value.info {
            color: #8b5cf6;
        }
        
        /* è¯¦ç»†åˆ†æ */
        .detail-analysis {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 24px;
        }
        
        @media (max-width: 768px) {
            .detail-analysis {
                grid-template-columns: 1fr;
            }
        }
        
        .cost-breakdown, .margin-breakdown {
            padding: 16px;
            border-radius: 8px;
            border: 1px solid var(--border);
        }
        
        .breakdown-item {
            display: flex;
            justify-content: space-between;
            padding: 10px 0;
            border-bottom: 1px solid var(--border);
        }
        
        .breakdown-item:last-child {
            border-bottom: none;
        }
        
        .breakdown-label {
            color: #475569;
            font-size: 13px;
        }
        
        .breakdown-value {
            font-weight: 600;
            color: var(--dark);
            font-size: 13px;
        }
        
        .breakdown-total {
            font-weight: 700;
            color: var(--primary);
            font-size: 14px;
        }
        
        /* æˆæœ¬åˆ©æ¶¦ç‡åˆ†æ */
        .margin-ratio-analysis {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 16px;
            margin-top: 16px;
        }
        
        .ratio-item {
            padding: 12px;
            border-radius: 8px;
            background: #f8fafc;
            text-align: center;
        }
        
        .ratio-label {
            font-size: 11px;
            color: #64748b;
            margin-bottom: 4px;
        }
        
        .ratio-value {
            font-size: 16px;
            font-weight: 700;
        }
        
        .ratio-value.high {
            color: var(--success);
        }
        
        .ratio-value.medium {
            color: var(--warning);
        }
        
        .ratio-value.low {
            color: #f97316;
        }
        
        /* æŒ‰é’® */
        .button-group {
            display: flex;
            gap: 12px;
            margin-top: 20px;
        }
        
        .btn {
            padding: 12px 16px;
            border: none;
            border-radius: 8px;
            font-size: 14px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.2s;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 6px;
        }
        
        .btn-primary {
            background: linear-gradient(135deg, var(--primary) 0%, var(--primary-light) 100%);
            color: white;
        }
        
        .btn-primary:hover {
            transform: translateY(-2px);
            box-shadow: 0 8px 20px rgba(37, 99, 235, 0.3);
        }
        
        .btn-secondary {
            background: white;
            color: var(--dark);
            border: 2px solid var(--border);
        }
        
        .btn-secondary:hover {
            background: var(--light);
            border-color: var(--primary);
        }
        
        .btn-success {
            background: linear-gradient(135deg, var(--success) 0%, #34d399 100%);
            color: white;
        }
        
        /* å ä½ç¬¦æ ·å¼ */
        .placeholder {
            color: #94a3b8;
            font-style: italic;
        }
        
        /* åŠ¨ç”» */
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(10px); }
            to { opacity: 1; transform: translateY(0); }
        }
        
        .fade-in {
            animation: fadeIn 0.3s ease-out;
        }
        
        /* é”™è¯¯æç¤º */
        .error-message {
            background: #fef2f2;
            border: 2px solid #fee2e2;
            color: #dc2626;
            padding: 10px 16px;
            border-radius: 8px;
            margin: 10px 0;
            font-size: 13px;
            display: flex;
            align-items: center;
            gap: 8px;
        }
        
        /* é€šçŸ¥ */
        .notification {
            position: fixed;
            top: 20px;
            right: 20px;
            padding: 12px 20px;
            border-radius: 8px;
            font-size: 14px;
            font-weight: 500;
            z-index: 1000;
            animation: fadeIn 0.3s ease-out;
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1);
            background: var(--success);
            color: white;
        }
        
        .notification.error {
            background: #ef4444;
        }
        
        .notification.warning {
            background: #f59e0b;
        }
        
        /* åŠ è½½çŠ¶æ€ */
        .loading {
            opacity: 0.7;
            pointer-events: none;
        }
        
        /* å›è½¦æç¤º */
        .enter-hint {
            position: absolute;
            right: 8px;
            top: 50%;
            transform: translateY(-50%);
            background: var(--primary);
            color: white;
            font-size: 10px;
            padding: 2px 6px;
            border-radius: 4px;
            opacity: 0;
            transition: opacity 0.2s;
            pointer-events: none;
        }
        
        .input-with-hint {
            position: relative;
        }
        
        /* è¡¨æ ¼å•å…ƒæ ¼æ ·å¼ */
        .table-cell-input {
            position: relative;
        }
        
        .discount-input-group {
            margin-bottom: 8px;
        }
    </style>
</head>
<body>
    <div class="container">
        <!-- å¤´éƒ¨ -->
        <div class="header">
            <div class="logo-area">
                <div class="logo">ğŸ’°</div>
                <div>
                    <h1 class="title">çµæ¢å®šä»·åˆ†æå·¥å…·</h1>
                    <p class="subtitle">å¤šSKUæˆæœ¬æ ¸å¯¹ Â· åŒè¡Œå¯¹æ ‡ Â· åˆ©æ¶¦åˆ†æ</p>
                </div>
            </div>
        </div>
        
        <!-- æˆæœ¬å‚æ•°é¢æ¿ -->
        <div class="cost-panel">
            <div class="section-title">ğŸ“Š æˆæœ¬å‚æ•°é…ç½®ï¼ˆå¯é€‰ï¼‰</div>
            
            <div class="params-grid">
                <div class="input-group">
                    <label class="input-label">
                        å¹³å°ä½£é‡‘æ¯”ä¾‹
                    </label>
                    <div class="input-wrapper">
                        <input type="number" id="platformFee" value="" min="0" max="50" step="0.1" placeholder="ä¾‹å¦‚ï¼š5">
                        <span class="currency">%</span>
                    </div>
                    <div class="input-tip">é€šå¸¸5-10%</div>
                </div>
                
                <div class="input-group">
                    <label class="input-label">
                        è¾¾äººä½£é‡‘æ¯”ä¾‹
                    </label>
                    <div class="input-wrapper">
                        <input type="number" id="kolFee" value="" min="0" max="50" step="0.1" placeholder="ä¾‹å¦‚ï¼š20">
                        <span class="currency">%</span>
                    </div>
                    <div class="input-tip">è¾¾äººå¸¦è´§ä½£é‡‘</div>
                </div>
                
                <div class="input-group">
                    <label class="input-label">
                        é€€è´§ç‡é¢„ä¼°
                    </label>
                    <div class="input-wrapper">
                        <input type="number" id="returnRate" value="" min="0" max="50" step="0.1" placeholder="ä¾‹å¦‚ï¼š5">
                        <span class="currency">%</span>
                    </div>
                    <div class="input-tip">è¡Œä¸šå¹³å‡5-15%</div>
                </div>
                
                <div class="input-group">
                    <label class="input-label">
                        å…¶ä»–æˆæœ¬
                    </label>
                    <div class="input-wrapper">
                        <input type="number" id="otherCost" value="" min="0" step="0.01" placeholder="åŒ…è£…ã€è¿è´¹ç­‰">
                        <span class="currency">å…ƒ</span>
                    </div>
                    <div class="input-tip">æ¯ä»¶å•†å“é¢å¤–æˆæœ¬</div>
                </div>
            </div>
            
            <div class="button-group">
                <button class="btn btn-primary" id="applyToAll">
                    ğŸ”„ åº”ç”¨åˆ°æ‰€æœ‰SKU
                </button>
                <button class="btn btn-secondary" id="resetConfig">
                    ğŸ”„ é‡ç½®é…ç½®
                </button>
            </div>
        </div>
        
        <!-- SKUç®¡ç† -->
        <div class="sku-management fade-in">
            <div class="sku-header">
                <div class="section-title">ğŸ“¦ SKUå®šä»·ç®¡ç†</div>
                <div class="sku-controls">
                    <button class="btn sku-btn add" id="addSKU">
                        â• æ·»åŠ SKU
                    </button>
                    <button class="btn btn-primary" id="calculateAll">
                        ğŸš€ æ‰¹é‡è®¡ç®—
                    </button>
                </div>
            </div>
            
            <div class="sku-table-container">
                <table class="sku-table">
                    <thead>
                        <tr>
                            <th width="120">SKUåç§°</th>
                            <th width="100">æˆæœ¬ä»·(å…ƒ)</th>
                            <th width="100">ç›®æ ‡å”®ä»·(å…ƒ)</th>
                            <th width="200">å•å“ç›´é™</th>
                            <th width="200">ä¼˜æƒ åˆ¸</th>
                            <th width="100">æœ€ç»ˆå”®ä»·(å…ƒ)</th>
                            <th width="90">æ¯›åˆ©(å…ƒ)</th>
                            <th width="80">æ¯›åˆ©ç‡</th>
                            <th width="80">æˆæœ¬æ¯›åˆ©ç‡</th>
                            <th width="90">å‡€åˆ©(å…ƒ)</th>
                            <th width="80">å‡€åˆ©ç‡</th>
                            <th width="70">æ“ä½œ</th>
                        </tr>
                    </thead>
                    <tbody id="skuTableBody">
                        <!-- SKUè¡Œå°†é€šè¿‡JavaScriptåŠ¨æ€æ·»åŠ  -->
                    </tbody>
                </table>
            </div>
            
            <div style="display: flex; justify-content: space-between; align-items: center;">
                <div style="font-size: 14px; color: #64748b;">
                    æ€»è®¡ <span id="skuCount" style="font-weight: 700; color: var(--primary);">0</span> ä¸ªSKU
                </div>
                <div>
                    <button class="btn btn-secondary" id="addSampleSKUs">
                        ğŸ“‹ æ·»åŠ ç¤ºä¾‹
                    </button>
                    <button class="btn btn-success" id="exportData">
                        ğŸ“¤ å¯¼å‡ºæ•°æ®
                    </button>
                </div>
            </div>
        </div>
        
        <!-- åˆ©æ¶¦åˆ†æ -->
        <div class="profit-analysis fade-in">
            <div class="section-title">ğŸ“ˆ æ€»ä½“åˆ©æ¶¦åˆ†æ</div>
            
            <div class="profit-summary">
                <div class="profit-card primary">
                    <div class="profit-label">æ€»é”€å”®é¢</div>
                    <div class="profit-value placeholder" id="totalRevenue">0å…ƒ</div>
                </div>
                
                <div class="profit-card success">
                    <div class="profit-label">æ€»æ¯›åˆ©æ¶¦</div>
                    <div class="profit-value placeholder" id="totalGrossProfit">0å…ƒ</div>
                </div>
                
                <div class="profit-card warning">
                    <div class="profit-label">å¹³å‡æ¯›åˆ©ç‡</div>
                    <div class="profit-value placeholder" id="avgGrossMargin">0%</div>
                </div>
                
                <div class="profit-card info">
                    <div class="profit-label">å¹³å‡æˆæœ¬æ¯›åˆ©ç‡</div>
                    <div class="profit-value placeholder" id="avgCostMargin">0%</div>
                </div>
                
                <div class="profit-card danger">
                    <div class="profit-label">å¹³å‡å‡€åˆ©ç‡</div>
                    <div class="profit-value placeholder" id="avgNetMargin">0%</div>
                </div>
            </div>
            
            <div class="detail-analysis">
                <div class="cost-breakdown">
                    <h4 style="margin-bottom: 12px; color: var(--dark); font-size: 15px;">æˆæœ¬æ„æˆåˆ†æ</h4>
                    <div class="breakdown-item">
                        <span class="breakdown-label">æ€»æˆæœ¬</span>
                        <span class="breakdown-value placeholder" id="totalCost">0å…ƒ</span>
                    </div>
                    <div class="breakdown-item">
                        <span class="breakdown-label">å¹³å°ä½£é‡‘</span>
                        <span class="breakdown-value placeholder" id="costPlatform">0å…ƒ</span>
                    </div>
                    <div class="breakdown-item">
                        <span class="breakdown-label">è¾¾äººä½£é‡‘</span>
                        <span class="breakdown-value placeholder" id="costKol">0å…ƒ</span>
                    </div>
                    <div class="breakdown-item">
                        <span class="breakdown-label">é€€è´§æŸå¤±</span>
                        <span class="breakdown-value placeholder" id="costReturn">0å…ƒ</span>
                    </div>
                    <div class="breakdown-item">
                        <span class="breakdown-label">å…¶ä»–æˆæœ¬</span>
                        <span class="breakdown-value placeholder" id="costOther">0å…ƒ</span>
                    </div>
                    <div class="breakdown-item" style="border-top: 1px solid var(--border); padding-top: 12px;">
                        <span class="breakdown-label breakdown-total">æ€»è´¹ç”¨</span>
                        <span class="breakdown-value breakdown-total placeholder" id="totalExpenses">0å…ƒ</span>
                    </div>
                </div>
                
                <div class="margin-breakdown">
                    <h4 style="margin-bottom: 12px; color: var(--dark); font-size: 15px;">åˆ©æ¶¦åˆ†å¸ƒåˆ†æ</h4>
                    <div class="breakdown-item">
                        <span class="breakdown-label">æœ€é«˜æ¯›åˆ©ç‡SKU</span>
                        <span class="breakdown-value placeholder" id="maxMarginSKU">-</span>
                    </div>
                    <div class="breakdown-item">
                        <span class="breakdown-label">æœ€é«˜æ¯›åˆ©ç‡</span>
                        <span class="breakdown-value placeholder" id="maxMarginValue">0%</span>
                    </div>
                    <div class="breakdown-item">
                        <span class="breakdown-label">æœ€ä½æ¯›åˆ©ç‡SKU</span>
                        <span class="breakdown-value placeholder" id="minMarginSKU">-</span>
                    </div>
                    <div class="breakdown-item">
                        <span class="breakdown-label">æœ€ä½æ¯›åˆ©ç‡</span>
                        <span class="breakdown-value placeholder" id="minMarginValue">0%</span>
                    </div>
                    <div class="breakdown-item">
                        <span class="breakdown-label">å»ºè®®ä¼˜åŒ–SKU</span>
                        <span class="breakdown-value placeholder" id="optimizeSKU">-</span>
                    </div>
                    
                    <div class="margin-ratio-analysis">
                        <div class="ratio-item">
                            <div class="ratio-label">æˆæœ¬åˆ©æ¶¦ç‡</div>
                            <div class="ratio-value placeholder" id="costProfitRatio">0%</div>
                        </div>
                        <div class="ratio-item">
                            <div class="ratio-label">æŠ•èµ„å›æŠ¥ç‡(ROI)</div>
                            <div class="ratio-value placeholder" id="roiRatio">0%</div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script>
        // å…¨å±€å˜é‡
        let skuList = [];
        let inputTimeout = null; // é˜²æŠ–è®¡æ—¶å™¨
        
        // åˆå§‹åŒ–é¡µé¢
        document.addEventListener('DOMContentLoaded', function() {
            setupEventListeners();
            addSampleSKUs(); // æ·»åŠ ç¤ºä¾‹SKUæ•°æ®ï¼ˆç°åœ¨åªæ·»åŠ 3ä¸ªï¼‰
        });
        
        // è®¾ç½®äº‹ä»¶ç›‘å¬å™¨
        function setupEventListeners() {
            // æˆæœ¬å‚æ•°è¾“å…¥äº‹ä»¶ - ä½¿ç”¨é˜²æŠ–
            const costInputIds = ['platformFee', 'kolFee', 'returnRate', 'otherCost'];
            costInputIds.forEach(id => {
                const element = document.getElementById(id);
                if (element) {
                    element.addEventListener('input', debounce(updateAllCalculations, 1000));
                }
            });
            
            // æŒ‰é’®äº‹ä»¶
            document.getElementById('applyToAll').addEventListener('click', applyToAllSKUs);
            document.getElementById('resetConfig').addEventListener('click', resetConfig);
            document.getElementById('addSKU').addEventListener('click', addSKU);
            document.getElementById('addSampleSKUs').addEventListener('click', addSampleSKUs);
            document.getElementById('calculateAll').addEventListener('click', calculateAllSKUs);
            document.getElementById('exportData').addEventListener('click', exportSKUData);
        }
        
        // é˜²æŠ–å‡½æ•°
        function debounce(func, delay) {
            return function() {
                clearTimeout(inputTimeout);
                const context = this;
                const args = arguments;
                inputTimeout = setTimeout(() => func.apply(context, args), delay);
            };
        }
        
        // æ·»åŠ ç¤ºä¾‹SKUæ•°æ® - ä¿®æ”¹ä¸ºåªæ·»åŠ 3ä¸ª
        function addSampleSKUs() {
            const sampleSKUs = [
                { id: 1, name: 'åŸºç¡€æ¬¾', cost: 85, targetPrice: 199, directDiscountType: 'percent', directDiscountValue: 10, couponDiscountType: 'percent', couponDiscountValue: 5 },
                { id: 2, name: 'å‡çº§æ¬¾', cost: 120, targetPrice: 299, directDiscountType: 'percent', directDiscountValue: 15, couponDiscountType: 'percent', couponDiscountValue: 8 },
                { id: 3, name: 'æ——èˆ°æ¬¾', cost: 200, targetPrice: 499, directDiscountType: 'amount', directDiscountValue: 50, couponDiscountType: 'percent', couponDiscountValue: 10 }
            ];
            
            // æ¸…ç©ºç°æœ‰SKU
            skuList = [];
            
            sampleSKUs.forEach(sku => {
                skuList.push({
                    id: sku.id,
                    name: sku.name,
                    cost: sku.cost,
                    targetPrice: sku.targetPrice,
                    directDiscountType: sku.directDiscountType,
                    directDiscountValue: sku.directDiscountValue,
                    couponDiscountType: sku.couponDiscountType,
                    couponDiscountValue: sku.couponDiscountValue,
                    directDiscount: 0,
                    couponAmount: 0,
                    finalPrice: 0,
                    grossProfit: 0,
                    grossMargin: 0,
                    costMargin: 0, // æ–°å¢ï¼šæˆæœ¬æ¯›åˆ©ç‡
                    netProfit: 0,
                    netMargin: 0,
                    // æ–°å¢å­—æ®µï¼šæŠ˜æ‰£é¢„è§ˆ
                    directDiscountPreview: 0,
                    couponDiscountPreview: 0,
                    priceAfterDirect: 0,
                    priceAfterAll: 0
                });
            });
            
            updateSKUTable();
            showNotification('å·²æ·»åŠ 3ä¸ªç¤ºä¾‹SKUæ•°æ®ï¼Œè¯·ç‚¹å‡»"æ‰¹é‡è®¡ç®—"æŒ‰é’®è¿›è¡Œè®¡ç®—', 'success');
        }
        
        // æ·»åŠ SKU
        function addSKU() {
            const newId = skuList.length > 0 ? Math.max(...skuList.map(sku => sku.id)) + 1 : 1;
            skuList.push({
                id: newId,
                name: `SKU-${String(newId).padStart(3, '0')}`,
                cost: 0,
                targetPrice: 0,
                directDiscountType: 'percent',
                directDiscountValue: 0,
                couponDiscountType: 'percent',
                couponDiscountValue: 0,
                directDiscount: 0,
                couponAmount: 0,
                finalPrice: 0,
                grossProfit: 0,
                grossMargin: 0,
                costMargin: 0, // æ–°å¢ï¼šæˆæœ¬æ¯›åˆ©ç‡
                netProfit: 0,
                netMargin: 0,
                // æ–°å¢å­—æ®µï¼šæŠ˜æ‰£é¢„è§ˆ
                directDiscountPreview: 0,
                couponDiscountPreview: 0,
                priceAfterDirect: 0,
                priceAfterAll: 0
            });
            
            updateSKUTable();
        }
        
        // ç§»é™¤SKU
        function removeSKU(id) {
            skuList = skuList.filter(sku => sku.id !== id);
            updateSKUTable();
            updateProfitSummary();
        }
        
        // æ›´æ–°SKUè¡¨æ ¼
        function updateSKUTable() {
            const tbody = document.getElementById('skuTableBody');
            tbody.innerHTML = '';
            
            skuList.forEach(sku => {
                // è®¡ç®—æŠ˜æ‰£é¢„è§ˆ
                updateDiscountPreview(sku);
                
                const row = document.createElement('tr');
                row.innerHTML = `
                    <td class="table-cell-input">
                        <input type="text" class="sku-name" value="${sku.name}" data-id="${sku.id}" placeholder="SKUåç§°">
                        <span class="enter-hint">Enter</span>
                    </td>
                    <td class="table-cell-input">
                        <input type="number" class="sku-cost" value="${sku.cost || ''}" min="0" step="0.01" data-id="${sku.id}" placeholder="æˆæœ¬ä»·">
                        <span class="enter-hint">Enter</span>
                    </td>
                    <td class="table-cell-input">
                        <input type="number" class="sku-target-price" value="${sku.targetPrice || ''}" min="0" step="0.01" data-id="${sku.id}" placeholder="å¯¹æ ‡åŒè¡Œ">
                        <span class="enter-hint">Enter</span>
                    </td>
                    <td>
                        <div class="discount-input-group">
                            <div class="discount-type" data-id="${sku.id}" data-type="direct">
                                <button class="type-btn ${sku.directDiscountType === 'percent' ? 'active' : ''}" data-type="percent">%</button>
                                <button class="type-btn ${sku.directDiscountType === 'amount' ? 'active' : ''}" data-type="amount">å…ƒ</button>
                            </div>
                            <div class="table-cell-input">
                                <input type="number" class="sku-direct-discount-value" value="${sku.directDiscountValue}" min="0" step="0.1" data-id="${sku.id}" placeholder="ç›´é™å€¼">
                                <span class="enter-hint">Enter</span>
                            </div>
                        </div>
                        <div class="discount-preview" data-id="${sku.id}" data-type="direct">
                            <div class="discount-preview-row">
                                <span class="discount-preview-label">å•å“ç›´é™ï¼š</span>
                                <span class="discount-preview-value ${getDiscountAmountColor(sku.directDiscountPreview, sku.targetPrice, 'direct')}" id="directPreviewAmount_${sku.id}">${sku.targetPrice > 0 ? sku.directDiscountPreview.toFixed(2) + 'å…ƒ' : 'éœ€è¾“å…¥å”®ä»·'}</span>
                            </div>
                            <div class="discount-preview-row">
                                <span class="discount-preview-label">ç›´é™åä»·æ ¼ï¼š</span>
                                <span class="discount-preview-value primary" id="priceAfterDirect_${sku.id}">${sku.targetPrice > 0 ? sku.priceAfterDirect.toFixed(2) + 'å…ƒ' : '-'}</span>
                            </div>
                        </div>
                    </td>
                    <td>
                        <div class="discount-input-group">
                            <div class="discount-type" data-id="${sku.id}" data-type="coupon">
                                <button class="type-btn ${sku.couponDiscountType === 'percent' ? 'active' : ''}" data-type="percent">%</button>
                                <button class="type-btn ${sku.couponDiscountType === 'amount' ? 'active' : ''}" data-type="amount">å…ƒ</button>
                            </div>
                            <div class="table-cell-input">
                                <input type="number" class="sku-coupon-discount-value" value="${sku.couponDiscountValue}" min="0" step="0.1" data-id="${sku.id}" placeholder="ä¼˜æƒ åˆ¸å€¼">
                                <span class="enter-hint">Enter</span>
                            </div>
                        </div>
                        <div class="discount-preview" data-id="${sku.id}" data-type="coupon">
                            <div class="discount-preview-row">
                                <span class="discount-preview-label">ä¼˜æƒ åˆ¸ï¼š</span>
                                <span class="discount-preview-value ${getDiscountAmountColor(sku.couponDiscountPreview, sku.priceAfterDirect, 'coupon')}" id="couponPreviewAmount_${sku.id}">${sku.targetPrice > 0 ? sku.couponDiscountPreview.toFixed(2) + 'å…ƒ' : 'éœ€è¾“å…¥å”®ä»·'}</span>
                            </div>
                            <div class="discount-preview-row discount-preview-total">
                                <span class="discount-preview-label">åˆè®¡ä¼˜æƒ ï¼š</span>
                                <span class="discount-preview-value warning" id="totalDiscount_${sku.id}">${sku.targetPrice > 0 ? (sku.directDiscountPreview + sku.couponDiscountPreview).toFixed(2) + 'å…ƒ' : '-'}</span>
                            </div>
                        </div>
                    </td>
                    <td class="sku-final-price ${sku.finalPrice > 0 ? 'profit-positive' : ''}">${sku.finalPrice > 0 ? sku.finalPrice.toFixed(2) : '-'}</td>
                    <td class="sku-gross-profit ${getProfitColor(sku.grossProfit)}">${sku.grossProfit > 0 ? sku.grossProfit.toFixed(2) : '-'}</td>
                    <td class="sku-gross-margin ${getMarginColor(sku.grossMargin)}">${sku.grossMargin > 0 ? sku.grossMargin.toFixed(1) + '%' : '-'}</td>
                    <td class="sku-cost-margin ${getCostMarginColor(sku.costMargin)}">${sku.costMargin > 0 ? sku.costMargin.toFixed(1) + '%' : '-'}</td>
                    <td class="sku-net-profit ${getProfitColor(sku.netProfit)}">${sku.netProfit > 0 ? sku.netProfit.toFixed(2) : '-'}</td>
                    <td class="sku-net-margin ${getMarginColor(sku.netMargin)}">${sku.netMargin > 0 ? sku.netMargin.toFixed(1) + '%' : '-'}</td>
                    <td>
                        <div class="sku-actions">
                            <button class="sku-btn calc" data-id="${sku.id}">è®¡ç®—</button>
                            <button class="sku-btn remove" data-id="${sku.id}">åˆ é™¤</button>
                        </div>
                    </td>
                `;
                tbody.appendChild(row);
            });
            
            // æ›´æ–°SKUè®¡æ•°
            document.getElementById('skuCount').textContent = skuList.length;
            
            // ç»‘å®šSKUè¡Œå†…äº‹ä»¶
            bindSKURowEvents();
        }
        
        // è®¡ç®—æŠ˜æ‰£é¢„è§ˆ
        function updateDiscountPreview(sku) {
            if (!sku.targetPrice || sku.targetPrice <= 0) {
                sku.directDiscountPreview = 0;
                sku.couponDiscountPreview = 0;
                sku.priceAfterDirect = 0;
                sku.priceAfterAll = 0;
                return;
            }
            
            // è®¡ç®—å•å“ç›´é™é‡‘é¢
            if (sku.directDiscountType === 'percent') {
                sku.directDiscountPreview = sku.targetPrice * (sku.directDiscountValue / 100);
            } else {
                sku.directDiscountPreview = parseFloat(sku.directDiscountValue) || 0;
            }
            
            // è®¡ç®—ç›´é™åä»·æ ¼
            sku.priceAfterDirect = sku.targetPrice - sku.directDiscountPreview;
            if (sku.priceAfterDirect < 0) sku.priceAfterDirect = 0;
            
            // è®¡ç®—ä¼˜æƒ åˆ¸é‡‘é¢
            if (sku.couponDiscountType === 'percent') {
                sku.couponDiscountPreview = sku.priceAfterDirect * (sku.couponDiscountValue / 100);
            } else {
                sku.couponDiscountPreview = parseFloat(sku.couponDiscountValue) || 0;
            }
            
            // è®¡ç®—åˆè®¡åä»·æ ¼
            sku.priceAfterAll = sku.priceAfterDirect - sku.couponDiscountPreview;
            if (sku.priceAfterAll < 0) sku.priceAfterAll = 0;
        }
        
        // æ›´æ–°æŠ˜æ‰£é¢„è§ˆæ˜¾ç¤º
        function updateDiscountPreviewDisplay(id) {
            const sku = skuList.find(s => s.id === id);
            if (!sku) return;
            
            // æ›´æ–°æŠ˜æ‰£é¢„è§ˆæ•°æ®
            updateDiscountPreview(sku);
            
            // æ›´æ–°æ˜¾ç¤º
            const directPreviewElement = document.getElementById(`directPreviewAmount_${id}`);
            const priceAfterDirectElement = document.getElementById(`priceAfterDirect_${id}`);
            const couponPreviewElement = document.getElementById(`couponPreviewAmount_${id}`);
            const totalDiscountElement = document.getElementById(`totalDiscount_${id}`);
            
            if (directPreviewElement && sku.targetPrice > 0) {
                directPreviewElement.textContent = sku.directDiscountPreview.toFixed(2) + 'å…ƒ';
                directPreviewElement.className = `discount-preview-value ${getDiscountAmountColor(sku.directDiscountPreview, sku.targetPrice, 'direct')}`;
            } else if (directPreviewElement) {
                directPreviewElement.textContent = 'éœ€è¾“å…¥å”®ä»·';
                directPreviewElement.className = 'discount-preview-value';
            }
            
            if (priceAfterDirectElement && sku.targetPrice > 0) {
                priceAfterDirectElement.textContent = sku.priceAfterDirect.toFixed(2) + 'å…ƒ';
            } else if (priceAfterDirectElement) {
                priceAfterDirectElement.textContent = '-';
            }
            
            if (couponPreviewElement && sku.targetPrice > 0) {
                couponPreviewElement.textContent = sku.couponDiscountPreview.toFixed(2) + 'å…ƒ';
                couponPreviewElement.className = `discount-preview-value ${getDiscountAmountColor(sku.couponDiscountPreview, sku.priceAfterDirect, 'coupon')}`;
            } else if (couponPreviewElement) {
                couponPreviewElement.textContent = 'éœ€è¾“å…¥å”®ä»·';
                couponPreviewElement.className = 'discount-preview-value';
            }
            
            if (totalDiscountElement && sku.targetPrice > 0) {
                const totalDiscount = sku.directDiscountPreview + sku.couponDiscountPreview;
                totalDiscountElement.textContent = totalDiscount.toFixed(2) + 'å…ƒ';
                
                // æ ¹æ®æ€»æŠ˜æ‰£æ¯”ä¾‹æ·»åŠ é¢œè‰²æç¤º
                const discountRate = (totalDiscount / sku.targetPrice) * 100;
                totalDiscountElement.className = `discount-preview-value ${getTotalDiscountColor(discountRate)}`;
            } else if (totalDiscountElement) {
                totalDiscountElement.textContent = '-';
                totalDiscountElement.className = 'discount-preview-value';
            }
        }
        
        // è·å–æŠ˜æ‰£é‡‘é¢é¢œè‰²
        function getDiscountAmountColor(discountAmount, basePrice, discountType) {
            if (!basePrice || basePrice <= 0) return '';
            
            const discountRate = (discountAmount / basePrice) * 100;
            
            if (discountType === 'direct') {
                // å•å“ç›´é™é¢œè‰²åˆ¤æ–­
                if (discountRate > 30) return 'danger'; // è¶…è¿‡30%é£é™©é«˜
                if (discountRate > 20) return 'warning'; // 20-30%éœ€è¦è°¨æ…
                if (discountRate > 10) return ''; // 10-20%æ­£å¸¸
                return 'primary'; // 10%ä»¥å†…æ¯”è¾ƒå®‰å…¨
            } else {
                // ä¼˜æƒ åˆ¸é¢œè‰²åˆ¤æ–­
                if (discountRate > 15) return 'danger'; // è¶…è¿‡15%é£é™©é«˜
                if (discountRate > 10) return 'warning'; // 10-15%éœ€è¦è°¨æ…
                if (discountRate > 5) return ''; // 5-10%æ­£å¸¸
                return 'primary'; // 5%ä»¥å†…æ¯”è¾ƒå®‰å…¨
            }
        }
        
        // è·å–æ€»æŠ˜æ‰£é¢œè‰²
        function getTotalDiscountColor(discountRate) {
            if (discountRate > 40) return 'danger'; // è¶…è¿‡40%é£é™©æé«˜
            if (discountRate > 30) return 'warning'; // 30-40%é£é™©é«˜
            if (discountRate > 20) return ''; // 20-30%æ­£å¸¸ä¿ƒé”€
            return 'primary'; // 20%ä»¥å†…å®‰å…¨
        }
        
        // è·å–åˆ©æ¶¦é¢œè‰²ç±»
        function getProfitColor(profit) {
            if (profit > 100) return 'profit-high';
            if (profit > 50) return 'profit-medium';
            if (profit > 20) return 'profit-low';
            if (profit > 0) return 'profit-very-low';
            return 'profit-negative';
        }
        
        // è·å–åˆ©æ¶¦ç‡é¢œè‰²ç±»ï¼ˆå”®ä»·æ¯›åˆ©ç‡ï¼‰
        function getMarginColor(margin) {
            if (margin > 40) return 'profit-high';
            if (margin > 25) return 'profit-medium';
            if (margin > 15) return 'profit-low';
            if (margin > 0) return 'profit-very-low';
            return 'profit-negative';
        }
        
        // è·å–æˆæœ¬æ¯›åˆ©ç‡é¢œè‰²ç±»
        function getCostMarginColor(costMargin) {
            if (costMargin > 150) return 'profit-high'; // è¶…è¿‡150%è¶…é«˜åˆ©æ¶¦
            if (costMargin > 80) return 'profit-medium'; // 80-150%é«˜åˆ©æ¶¦
            if (costMargin > 40) return 'profit-low'; // 40-80%ä¸­ç­‰åˆ©æ¶¦
            if (costMargin > 20) return 'profit-very-low'; // 20-40%ä½åˆ©æ¶¦
            if (costMargin > 0) return 'profit-negative'; // 0-20%å¾®åˆ©
            return 'profit-negative'; // äºæŸ
        }
        
        // ç»‘å®šSKUè¡Œå†…äº‹ä»¶ - ä½¿ç”¨é˜²æŠ–
        function bindSKURowEvents() {
            // ç»‘å®šSKUåç§°è¾“å…¥äº‹ä»¶
            document.querySelectorAll('.sku-name').forEach(input => {
                input.addEventListener('input', function() {
                    const id = parseInt(this.getAttribute('data-id'));
                    const sku = skuList.find(s => s.id === id);
                    if (sku) sku.name = this.value;
                });
                
                // æ·»åŠ å›è½¦é”®äº‹ä»¶
                addEnterKeyListener(input, id => updateSingleSKU(id));
            });
            
            // ç»‘å®šæˆæœ¬è¾“å…¥äº‹ä»¶ - ä½¿ç”¨é˜²æŠ–
            document.querySelectorAll('.sku-cost').forEach(input => {
                input.addEventListener('input', debounce(function() {
                    const id = parseInt(this.getAttribute('data-id'));
                    const sku = skuList.find(s => s.id === id);
                    if (sku) {
                        sku.cost = parseFloat(this.value) || 0;
                        updateDiscountPreviewDisplay(id); // æ›´æ–°æŠ˜æ‰£é¢„è§ˆ
                    }
                }, 800));
                
                // æ·»åŠ å›è½¦é”®äº‹ä»¶
                addEnterKeyListener(input, id => updateSingleSKU(id));
            });
            
            // ç»‘å®šç›®æ ‡å”®ä»·è¾“å…¥äº‹ä»¶ - ä½¿ç”¨é˜²æŠ–
            document.querySelectorAll('.sku-target-price').forEach(input => {
                input.addEventListener('input', debounce(function() {
                    const id = parseInt(this.getAttribute('data-id'));
                    const sku = skuList.find(s => s.id === id);
                    if (sku) {
                        sku.targetPrice = parseFloat(this.value) || 0;
                        // å®æ—¶æ›´æ–°æŠ˜æ‰£é¢„è§ˆ
                        updateDiscountPreviewDisplay(id);
                    }
                }, 500));
                
                // æ·»åŠ å›è½¦é”®äº‹ä»¶
                addEnterKeyListener(input, id => updateSingleSKU(id));
            });
            
            // ç»‘å®šå•å“ç›´é™å€¼è¾“å…¥äº‹ä»¶ - ä½¿ç”¨é˜²æŠ–
            document.querySelectorAll('.sku-direct-discount-value').forEach(input => {
                input.addEventListener('input', debounce(function() {
                    const id = parseInt(this.getAttribute('data-id'));
                    const sku = skuList.find(s => s.id === id);
                    if (sku) {
                        sku.directDiscountValue = parseFloat(this.value) || 0;
                        // å®æ—¶æ›´æ–°æŠ˜æ‰£é¢„è§ˆ
                        updateDiscountPreviewDisplay(id);
                    }
                }, 500));
                
                // æ·»åŠ å›è½¦é”®äº‹ä»¶
                addEnterKeyListener(input, id => updateSingleSKU(id));
            });
            
            // ç»‘å®šä¼˜æƒ åˆ¸å€¼è¾“å…¥äº‹ä»¶ - ä½¿ç”¨é˜²æŠ–
            document.querySelectorAll('.sku-coupon-discount-value').forEach(input => {
                input.addEventListener('input', debounce(function() {
                    const id = parseInt(this.getAttribute('data-id'));
                    const sku = skuList.find(s => s.id === id);
                    if (sku) {
                        sku.couponDiscountValue = parseFloat(this.value) || 0;
                        // å®æ—¶æ›´æ–°æŠ˜æ‰£é¢„è§ˆ
                        updateDiscountPreviewDisplay(id);
                    }
                }, 500));
                
                // æ·»åŠ å›è½¦é”®äº‹ä»¶
                addEnterKeyListener(input, id => updateSingleSKU(id));
            });
            
            // ç»‘å®šæŠ˜æ‰£ç±»å‹åˆ‡æ¢äº‹ä»¶
            document.querySelectorAll('.discount-type').forEach(container => {
                const id = parseInt(container.getAttribute('data-id'));
                const type = container.getAttribute('data-type'); // 'direct' æˆ– 'coupon'
                
                container.querySelectorAll('.type-btn').forEach(btn => {
                    btn.addEventListener('click', function() {
                        const discountType = this.getAttribute('data-type');
                        const sku = skuList.find(s => s.id === id);
                        
                        if (sku) {
                            if (type === 'direct') {
                                sku.directDiscountType = discountType;
                            } else {
                                sku.couponDiscountType = discountType;
                            }
                            
                            // æ›´æ–°æŒ‰é’®çŠ¶æ€
                            container.querySelectorAll('.type-btn').forEach(b => b.classList.remove('active'));
                            this.classList.add('active');
                            
                            // å®æ—¶æ›´æ–°æŠ˜æ‰£é¢„è§ˆ
                            updateDiscountPreviewDisplay(id);
                        }
                    });
                });
            });
            
            // ç»‘å®šå•ä¸ªSKUè®¡ç®—æŒ‰é’®
            document.querySelectorAll('.sku-btn.calc').forEach(btn => {
                btn.addEventListener('click', function() {
                    const id = parseInt(this.getAttribute('data-id'));
                    updateSingleSKU(id);
                });
            });
            
            // ç»‘å®šåˆ é™¤æŒ‰é’®
            document.querySelectorAll('.sku-btn.remove').forEach(btn => {
                btn.addEventListener('click', function() {
                    const id = parseInt(this.getAttribute('data-id'));
                    removeSKU(id);
                });
            });
        }
        
        // æ·»åŠ å›è½¦é”®ç›‘å¬å™¨
        function addEnterKeyListener(inputElement, callback) {
            inputElement.addEventListener('keydown', function(event) {
                if (event.key === 'Enter') {
                    event.preventDefault();
                    const id = parseInt(this.getAttribute('data-id'));
                    
                    // æ›´æ–°æ•°æ®ï¼ˆç«‹å³æ›´æ–°ï¼Œä¸ç­‰å¾…é˜²æŠ–ï¼‰
                    const sku = skuList.find(s => s.id === id);
                    if (sku) {
                        const value = this.value.trim();
                        
                        // æ ¹æ®è¾“å…¥æ¡†ç±»å‹æ›´æ–°ç›¸åº”çš„å­—æ®µ
                        if (this.classList.contains('sku-name')) {
                            sku.name = value;
                        } else if (this.classList.contains('sku-cost')) {
                            sku.cost = parseFloat(value) || 0;
                        } else if (this.classList.contains('sku-target-price')) {
                            sku.targetPrice = parseFloat(value) || 0;
                        } else if (this.classList.contains('sku-direct-discount-value')) {
                            sku.directDiscountValue = parseFloat(value) || 0;
                        } else if (this.classList.contains('sku-coupon-discount-value')) {
                            sku.couponDiscountValue = parseFloat(value) || 0;
                        }
                        
                        // æ›´æ–°æŠ˜æ‰£é¢„è§ˆ
                        updateDiscountPreviewDisplay(id);
                    }
                    
                    // æ‰§è¡Œè®¡ç®—
                    callback(id);
                    
                    // ç§»é™¤ç„¦ç‚¹ï¼Œéšè—å›è½¦æç¤º
                    this.blur();
                }
            });
        }
        
        // æ›´æ–°æ‰€æœ‰è®¡ç®—
        function updateAllCalculations() {
            calculateAllSKUs();
        }
        
        // æ›´æ–°å•ä¸ªSKU
        function updateSingleSKU(id) {
            const sku = skuList.find(s => s.id === id);
            if (!sku) return;
            
            // è·å–æˆæœ¬å‚æ•°
            const platformFeePercent = parseFloat(document.getElementById('platformFee').value) / 100 || 0;
            const kolFeePercent = parseFloat(document.getElementById('kolFee').value) / 100 || 0;
            const returnRatePercent = parseFloat(document.getElementById('returnRate').value) / 100 || 0;
            const otherCost = parseFloat(document.getElementById('otherCost').value) || 0;
            
            // å¦‚æœæ²¡æœ‰ç›®æ ‡å”®ä»·ï¼Œåˆ™æ— æ³•è®¡ç®—æœ€ç»ˆå”®ä»·å’Œåˆ©æ¶¦
            if (sku.targetPrice <= 0) {
                // é‡ç½®æ•°æ®
                sku.finalPrice = 0;
                sku.grossProfit = 0;
                sku.grossMargin = 0;
                sku.costMargin = 0;
                sku.netProfit = 0;
                sku.netMargin = 0;
                sku.directDiscount = 0;
                sku.couponAmount = 0;
                
                // æ›´æ–°è¡¨æ ¼æ˜¾ç¤º
                updateSKUTable();
                updateProfitSummary();
                showNotification('è¯·å…ˆå¡«å†™ç›®æ ‡å”®ä»·', 'warning');
                return;
            }
            
            // åŸºå‡†ä»·ä¸ºç›®æ ‡å”®ä»·
            const basePrice = sku.targetPrice;
            
            // è®¡ç®—å•å“ç›´é™é‡‘é¢
            let directDiscountAmount = 0;
            if (sku.directDiscountType === 'percent') {
                directDiscountAmount = basePrice * (sku.directDiscountValue / 100);
            } else {
                directDiscountAmount = sku.directDiscountValue;
            }
            
            // è®¡ç®—ä¼˜æƒ åˆ¸é‡‘é¢ï¼ˆåŸºäºå•å“ç›´é™åä»·æ ¼ï¼‰
            const priceAfterDirect = basePrice - directDiscountAmount;
            let couponAmount = 0;
            
            if (sku.couponDiscountType === 'percent') {
                couponAmount = priceAfterDirect * (sku.couponDiscountValue / 100);
            } else {
                couponAmount = sku.couponDiscountValue;
            }
            
            sku.directDiscount = directDiscountAmount;
            sku.couponAmount = couponAmount;
            
            // è®¡ç®—æœ€ç»ˆå”®ä»·
            sku.finalPrice = basePrice - directDiscountAmount - couponAmount;
            
            // è®¡ç®—åˆ©æ¶¦ï¼ˆå¿…é¡»æœ‰æˆæœ¬ä»·ï¼‰
            if (sku.finalPrice > 0 && sku.cost > 0) {
                // è®¡ç®—æ¯›åˆ©æ¶¦
                sku.grossProfit = sku.finalPrice - sku.cost;
                
                // è®¡ç®—å”®ä»·æ¯›åˆ©ç‡ï¼š(å”®ä»·-æˆæœ¬)/å”®ä»·Ã—100%
                sku.grossMargin = sku.finalPrice > 0 ? (sku.grossProfit / sku.finalPrice) * 100 : 0;
                
                // è®¡ç®—æˆæœ¬æ¯›åˆ©ç‡ï¼š(å”®ä»·-æˆæœ¬)/æˆæœ¬Ã—100%
                sku.costMargin = sku.cost > 0 ? (sku.grossProfit / sku.cost) * 100 : 0;
                
                // è®¡ç®—å…¶ä»–æˆæœ¬
                const platformFee = sku.finalPrice * platformFeePercent;
                const kolFee = sku.finalPrice * kolFeePercent;
                const returnLoss = sku.finalPrice * returnRatePercent;
                const totalOtherCosts = platformFee + kolFee + returnLoss + otherCost;
                
                // è®¡ç®—å‡€åˆ©æ¶¦
                sku.netProfit = sku.grossProfit - totalOtherCosts;
                sku.netMargin = sku.finalPrice > 0 ? (sku.netProfit / sku.finalPrice) * 100 : 0;
            } else {
                sku.grossProfit = 0;
                sku.grossMargin = 0;
                sku.costMargin = 0;
                sku.netProfit = 0;
                sku.netMargin = 0;
            }
            
            // æ›´æ–°è¡¨æ ¼æ˜¾ç¤º
            updateSKUTable();
            updateProfitSummary();
            
            // æ˜¾ç¤ºæˆåŠŸæ¶ˆæ¯
            if (sku.finalPrice > 0 && sku.cost > 0) {
                showNotification(`${sku.name} è®¡ç®—å®Œæˆï¼æœ€ç»ˆå”®ä»·ï¼šÂ¥${sku.finalPrice.toFixed(2)}ï¼Œå”®ä»·æ¯›åˆ©ç‡ï¼š${sku.grossMargin.toFixed(1)}%ï¼Œæˆæœ¬æ¯›åˆ©ç‡ï¼š${sku.costMargin.toFixed(1)}%`, 'success');
            }
        }
        
        // è®¡ç®—æ‰€æœ‰SKU
        function calculateAllSKUs() {
            let calculatedCount = 0;
            let missingTargetPriceCount = 0;
            let missingCostCount = 0;
            
            skuList.forEach(sku => {
                if (sku.targetPrice > 0 && sku.cost > 0) {
                    updateSingleSKU(sku.id);
                    calculatedCount++;
                } else {
                    if (sku.targetPrice <= 0) missingTargetPriceCount++;
                    if (sku.cost <= 0) missingCostCount++;
                }
            });
            
            if (calculatedCount > 0) {
                showNotification(`æˆåŠŸè®¡ç®— ${calculatedCount} ä¸ªSKU`, 'success');
                if (missingTargetPriceCount > 0 || missingCostCount > 0) {
                    const missingMsg = [];
                    if (missingTargetPriceCount > 0) missingMsg.push(`${missingTargetPriceCount}ä¸ªSKUç¼ºå°‘ç›®æ ‡å”®ä»·`);
                    if (missingCostCount > 0) missingMsg.push(`${missingCostCount}ä¸ªSKUç¼ºå°‘æˆæœ¬ä»·`);
                    showNotification(`${missingMsg.join('ï¼Œ')}ï¼Œæ— æ³•è®¡ç®—`, 'warning');
                }
            } else {
                showNotification('è¯·å…ˆå¡«å†™SKUçš„æˆæœ¬ä»·å’Œç›®æ ‡å”®ä»·', 'warning');
            }
        }
        
        // åº”ç”¨åˆ°æ‰€æœ‰SKU
        function applyToAllSKUs() {
            showNotification('æˆæœ¬å‚æ•°å·²ä¿å­˜', 'success');
        }
        
        // é‡ç½®é…ç½®
        function resetConfig() {
            if (confirm('ç¡®å®šè¦é‡ç½®æ‰€æœ‰æˆæœ¬å‚æ•°å—ï¼Ÿ')) {
                // é‡ç½®æˆæœ¬å‚æ•°ï¼ˆæ¸…ç©ºï¼‰
                document.getElementById('platformFee').value = '';
                document.getElementById('kolFee').value = '';
                document.getElementById('returnRate').value = '';
                document.getElementById('otherCost').value = '';
                
                showNotification('æˆæœ¬å‚æ•°å·²é‡ç½®', 'success');
            }
        }
        
        // æ›´æ–°åˆ©æ¶¦æ±‡æ€»
        function updateProfitSummary() {
            const validSKUs = skuList.filter(sku => sku.finalPrice > 0 && sku.cost > 0);
            
            if (validSKUs.length === 0) {
                // é‡ç½®æ±‡æ€»æ•°æ®
                document.getElementById('totalRevenue').textContent = '0å…ƒ';
                document.getElementById('totalGrossProfit').textContent = '0å…ƒ';
                document.getElementById('avgGrossMargin').textContent = '0%';
                document.getElementById('avgCostMargin').textContent = '0%';
                document.getElementById('avgNetMargin').textContent = '0%';
                document.getElementById('totalCost').textContent = '0å…ƒ';
                document.getElementById('costPlatform').textContent = '0å…ƒ';
                document.getElementById('costKol').textContent = '0å…ƒ';
                document.getElementById('costReturn').textContent = '0å…ƒ';
                document.getElementById('costOther').textContent = '0å…ƒ';
                document.getElementById('totalExpenses').textContent = '0å…ƒ';
                document.getElementById('costProfitRatio').textContent = '0%';
                document.getElementById('roiRatio').textContent = '0%';
                
                // é‡ç½®åˆ©æ¶¦åˆ†å¸ƒ
                document.getElementById('maxMarginSKU').textContent = '-';
                document.getElementById('maxMarginValue').textContent = '0%';
                document.getElementById('minMarginSKU').textContent = '-';
                document.getElementById('minMarginValue').textContent = '0%';
                document.getElementById('optimizeSKU').textContent = '-';
                
                return;
            }
            
            // è®¡ç®—æ€»é¢
            const totalRevenue = validSKUs.reduce((sum, sku) => sum + sku.finalPrice, 0);
            const totalCost = validSKUs.reduce((sum, sku) => sum + sku.cost, 0);
            const totalGrossProfit = validSKUs.reduce((sum, sku) => sum + sku.grossProfit, 0);
            const totalNetProfit = validSKUs.reduce((sum, sku) => sum + sku.netProfit, 0);
            
            // è®¡ç®—å¹³å‡åˆ©æ¶¦ç‡
            const avgGrossMargin = validSKUs.reduce((sum, sku) => sum + sku.grossMargin, 0) / validSKUs.length;
            const avgCostMargin = validSKUs.reduce((sum, sku) => sum + sku.costMargin, 0) / validSKUs.length;
            const avgNetMargin = validSKUs.reduce((sum, sku) => sum + sku.netMargin, 0) / validSKUs.length;
            
            // è®¡ç®—å…¶ä»–æˆæœ¬
            const platformFeePercent = parseFloat(document.getElementById('platformFee').value) / 100 || 0;
            const kolFeePercent = parseFloat(document.getElementById('kolFee').value) / 100 || 0;
            const returnRatePercent = parseFloat(document.getElementById('returnRate').value) / 100 || 0;
            const otherCost = parseFloat(document.getElementById('otherCost').value) || 0;
            
            const costPlatform = totalRevenue * platformFeePercent;
            const costKol = totalRevenue * kolFeePercent;
            const costReturn = totalRevenue * returnRatePercent;
            const costOther = otherCost * validSKUs.length;
            const totalExpenses = costPlatform + costKol + costReturn + costOther;
            
            // è®¡ç®—æˆæœ¬åˆ©æ¶¦ç‡ï¼ˆæ€»åˆ©æ¶¦/æ€»æˆæœ¬Ã—100%ï¼‰
            const costProfitRatio = totalCost > 0 ? (totalGrossProfit / totalCost) * 100 : 0;
            
            // è®¡ç®—æŠ•èµ„å›æŠ¥ç‡ROIï¼ˆå‡€åˆ©æ¶¦/æ€»æˆæœ¬Ã—100%ï¼‰
            const roiRatio = totalCost > 0 ? (totalNetProfit / totalCost) * 100 : 0;
            
            // æ›´æ–°æ±‡æ€»æ˜¾ç¤º
            document.getElementById('totalRevenue').textContent = totalRevenue.toFixed(2) + 'å…ƒ';
            document.getElementById('totalGrossProfit').textContent = totalGrossProfit.toFixed(2) + 'å…ƒ';
            document.getElementById('avgGrossMargin').textContent = avgGrossMargin.toFixed(1) + '%';
            document.getElementById('avgCostMargin').textContent = avgCostMargin.toFixed(1) + '%';
            document.getElementById('avgNetMargin').textContent = avgNetMargin.toFixed(1) + '%';
            document.getElementById('totalCost').textContent = totalCost.toFixed(2) + 'å…ƒ';
            document.getElementById('costPlatform').textContent = costPlatform.toFixed(2) + 'å…ƒ';
            document.getElementById('costKol').textContent = costKol.toFixed(2) + 'å…ƒ';
            document.getElementById('costReturn').textContent = costReturn.toFixed(2) + 'å…ƒ';
            document.getElementById('costOther').textContent = costOther.toFixed(2) + 'å…ƒ';
            document.getElementById('totalExpenses').textContent = totalExpenses.toFixed(2) + 'å…ƒ';
            document.getElementById('costProfitRatio').textContent = costProfitRatio.toFixed(1) + '%';
            document.getElementById('roiRatio').textContent = roiRatio.toFixed(1) + '%';
            
            // æ›´æ–°åˆ©æ¶¦æ˜¾ç¤ºé¢œè‰²
            updateProfitColor(avgGrossMargin, 'avgGrossMargin');
            updateProfitColor(avgCostMargin, 'avgCostMargin');
            updateProfitColor(avgNetMargin, 'avgNetMargin');
            updateProfitColor(totalGrossProfit, 'totalGrossProfit');
            
            // æ›´æ–°æˆæœ¬åˆ©æ¶¦ç‡é¢œè‰²
            updateCostMarginColor(avgCostMargin, 'avgCostMargin');
            
            // æ›´æ–°æˆæœ¬åˆ©æ¶¦ç‡åˆ†æé¢œè‰²
            updateRatioColor(costProfitRatio, 'costProfitRatio');
            updateRatioColor(roiRatio, 'roiRatio');
            
            // è®¡ç®—åˆ©æ¶¦åˆ†å¸ƒ
            const margins = validSKUs.map(sku => sku.grossMargin);
            const maxMargin = Math.max(...margins);
            const minMargin = Math.min(...margins);
            const maxMarginSKU = validSKUs.find(sku => sku.grossMargin === maxMargin);
            const minMarginSKU = validSKUs.find(sku => sku.grossMargin === minMargin);
            
            // å»ºè®®ä¼˜åŒ–SKUï¼ˆæ¯›åˆ©ç‡æœ€ä½çš„ï¼‰
            const optimizeSKU = minMarginSKU;
            
            // æ›´æ–°åˆ©æ¶¦åˆ†å¸ƒæ˜¾ç¤º
            document.getElementById('maxMarginSKU').textContent = maxMarginSKU ? maxMarginSKU.name : '-';
            document.getElementById('maxMarginValue').textContent = maxMargin.toFixed(1) + '%';
            document.getElementById('minMarginSKU').textContent = minMarginSKU ? minMarginSKU.name : '-';
            document.getElementById('minMarginValue').textContent = minMargin.toFixed(1) + '%';
            document.getElementById('optimizeSKU').textContent = optimizeSKU ? optimizeSKU.name : '-';
        }
        
        // æ›´æ–°åˆ©æ¶¦æ˜¾ç¤ºé¢œè‰²
        function updateProfitColor(value, elementId) {
            const element = document.getElementById(elementId);
            if (!element) return;
            
            element.classList.remove('success', 'warning', 'danger', 'info');
            
            if (typeof value === 'number') {
                if (elementId.includes('GrossMargin') || elementId.includes('NetMargin')) {
                    // å”®ä»·æ¯›åˆ©ç‡æˆ–å‡€åˆ©ç‡
                    if (value > 30) {
                        element.classList.add('success');
                    } else if (value > 15) {
                        element.classList.add('warning');
                    } else if (value > 0) {
                        element.classList.add('danger');
                    } else {
                        element.classList.add('danger');
                    }
                } else if (elementId.includes('CostMargin')) {
                    // æˆæœ¬æ¯›åˆ©ç‡ç”¨ä¸åŒæ ‡å‡†
                    if (value > 80) {
                        element.classList.add('success');
                    } else if (value > 40) {
                        element.classList.add('warning');
                    } else if (value > 20) {
                        element.classList.add('danger');
                    } else {
                        element.classList.add('danger');
                    }
                } else {
                    // åˆ©æ¶¦é‡‘é¢
                    if (value > 0) {
                        element.classList.add('success');
                    } else {
                        element.classList.add('danger');
                    }
                }
            }
        }
        
        // æ›´æ–°æˆæœ¬æ¯›åˆ©ç‡é¢œè‰²
        function updateCostMarginColor(value, elementId) {
            const element = document.getElementById(elementId);
            if (!element) return;
            
            element.classList.remove('success', 'warning', 'danger', 'info');
            
            if (value > 80) {
                element.classList.add('info'); // ç´«è‰²è¡¨ç¤ºé«˜åˆ©æ¶¦
            } else if (value > 40) {
                element.classList.add('success');
            } else if (value > 20) {
                element.classList.add('warning');
            } else if (value > 0) {
                element.classList.add('danger');
            } else {
                element.classList.add('danger');
            }
        }
        
        // æ›´æ–°æ¯”ç‡é¢œè‰²
        function updateRatioColor(value, elementId) {
            const element = document.getElementById(elementId);
            if (!element) return;
            
            element.classList.remove('high', 'medium', 'low');
            
            if (value > 100) {
                element.classList.add('high');
            } else if (value > 50) {
                element.classList.add('medium');
            } else if (value > 20) {
                element.classList.add('low');
            }
        }
        
        // å¯¼å‡ºSKUæ•°æ®
        function exportSKUData() {
            if (skuList.length === 0) {
                showNotification('æ²¡æœ‰SKUæ•°æ®å¯ä»¥å¯¼å‡º', 'error');
                return;
            }
            
            const validSKUs = skuList.filter(sku => sku.finalPrice > 0 && sku.cost > 0);
            
            if (validSKUs.length === 0) {
                showNotification('æ²¡æœ‰å·²è®¡ç®—çš„SKUæ•°æ®å¯ä»¥å¯¼å‡º', 'warning');
                return;
            }
            
            const exportData = {
                å¯¼å‡ºæ—¶é—´: new Date().toLocaleString(),
                SKUæ€»æ•°: skuList.length,
                å·²è®¡ç®—SKUæ•°: validSKUs.length,
                æˆæœ¬å‚æ•°: {
                    å¹³å°ä½£é‡‘æ¯”ä¾‹: document.getElementById('platformFee').value || '0' + '%',
                    è¾¾äººä½£é‡‘æ¯”ä¾‹: document.getElementById('kolFee').value || '0' + '%',
                    é€€è´§ç‡é¢„ä¼°: document.getElementById('returnRate').value || '0' + '%',
                    å…¶ä»–æˆæœ¬: document.getElementById('otherCost').value || '0' + 'å…ƒ'
                },
                SKUåˆ—è¡¨: validSKUs.map(sku => ({
                    SKUåç§°: sku.name,
                    å®é™…æˆæœ¬: sku.cost.toFixed(2) + 'å…ƒ',
                    ç›®æ ‡å”®ä»·: sku.targetPrice.toFixed(2) + 'å…ƒ',
                    å•å“ç›´é™ç±»å‹: sku.directDiscountType === 'percent' ? 'ç™¾åˆ†æ¯”' : 'å›ºå®šé‡‘é¢',
                    å•å“ç›´é™å€¼: sku.directDiscountValue + (sku.directDiscountType === 'percent' ? '%' : 'å…ƒ'),
                    å•å“ç›´é™é‡‘é¢: sku.directDiscount.toFixed(2) + 'å…ƒ',
                    ä¼˜æƒ åˆ¸ç±»å‹: sku.couponDiscountType === 'percent' ? 'ç™¾åˆ†æ¯”' : 'å›ºå®šé‡‘é¢',
                    ä¼˜æƒ åˆ¸å€¼: sku.couponDiscountValue + (sku.couponDiscountType === 'percent' ? '%' : 'å…ƒ'),
                    ä¼˜æƒ åˆ¸é‡‘é¢: sku.couponAmount.toFixed(2) + 'å…ƒ',
                    æœ€ç»ˆå”®ä»·: sku.finalPrice.toFixed(2) + 'å…ƒ',
                    æ¯›åˆ©: sku.grossProfit.toFixed(2) + 'å…ƒ',
                    æ¯›åˆ©ç‡: sku.grossMargin.toFixed(1) + '%',
                    æˆæœ¬æ¯›åˆ©ç‡: sku.costMargin.toFixed(1) + '%',
                    å‡€åˆ©: sku.netProfit.toFixed(2) + 'å…ƒ',
                    å‡€åˆ©ç‡: sku.netMargin.toFixed(1) + '%'
                })),
                æ±‡æ€»ä¿¡æ¯: {
                    æ€»é”€å”®é¢: document.getElementById('totalRevenue').textContent,
                    æ€»æ¯›åˆ©æ¶¦: document.getElementById('totalGrossProfit').textContent,
                    å¹³å‡æ¯›åˆ©ç‡: document.getElementById('avgGrossMargin').textContent,
                    å¹³å‡æˆæœ¬æ¯›åˆ©ç‡: document.getElementById('avgCostMargin').textContent,
                    å¹³å‡å‡€åˆ©ç‡: document.getElementById('avgNetMargin').textContent,
                    æˆæœ¬åˆ©æ¶¦ç‡: document.getElementById('costProfitRatio').textContent,
                    æŠ•èµ„å›æŠ¥ç‡: document.getElementById('roiRatio').textContent
                }
            };
            
            const dataStr = JSON.stringify(exportData, null, 2);
            const blob = new Blob([dataStr], {type: 'application/json'});
            const url = URL.createObjectURL(blob);
            
            const a = document.createElement('a');
            a.href = url;
            a.download = `SKUå®šä»·åˆ†æ_${new Date().getTime()}.json`;
            document.body.appendChild(a);
            a.click();
            document.body.removeChild(a);
            
            showNotification('SKUæ•°æ®å·²å¯¼å‡ºä¸ºJSONæ–‡ä»¶', 'success');
        }
        
        // æ˜¾ç¤ºé€šçŸ¥
        function showNotification(message, type) {
            const notification = document.createElement('div');
            notification.className = `notification ${type}`;
            notification.textContent = message;
            document.body.appendChild(notification);
            
            setTimeout(() => {
                notification.style.opacity = '0';
                notification.style.transition = 'opacity 0.3s';
                setTimeout(() => {
                    document.body.removeChild(notification);
                }, 300);
            }, 3000);
        }
    </script>
    
    <style>
        /* åˆ©æ¶¦é¢œè‰²æ ·å¼ */
        .profit-high {
            color: var(--success);
            font-weight: 700;
        }
        
        .profit-medium {
            color: var(--warning);
            font-weight: 700;
        }
        
        .profit-low {
            color: #f59e0b;
            font-weight: 700;
        }
        
        .profit-very-low {
            color: #f97316;
            font-weight: 700;
        }
        
        .profit-negative {
            color: var(--danger);
            font-weight: 700;
        }
        
        .profit-positive {
            color: var(--primary);
            font-weight: 600;
        }
        
        /* è¡¨æ ¼ä¸­çš„åˆ©æ¶¦é¢œè‰² */
        .sku-gross-profit.profit-high,
        .sku-net-profit.profit-high {
            color: var(--success);
            font-weight: 600;
        }
        
        .sku-gross-profit.profit-medium,
        .sku-net-profit.profit-medium {
            color: var(--warning);
            font-weight: 600;
        }
        
        .sku-gross-profit.profit-low,
        .sku-net-profit.profit-low {
            color: #f59e0b;
            font-weight: 600;
        }
        
        .sku-gross-profit.profit-very-low,
        .sku-net-profit.profit-very-low {
            color: #f97316;
            font-weight: 600;
        }
        
        .sku-gross-profit.profit-negative,
        .sku-net-profit.profit-negative {
            color: var(--danger);
            font-weight: 600;
        }
        
        .sku-gross-margin.profit-high,
        .sku-net-margin.profit-high {
            color: var(--success);
            font-weight: 600;
        }
        
        .sku-gross-margin.profit-medium,
        .sku-net-margin.profit-medium {
            color: var(--warning);
            font-weight: 600;
        }
        
        .sku-gross-margin.profit-low,
        .sku-net-margin.profit-low {
            color: #f59e0b;
            font-weight: 600;
        }
        
        .sku-gross-margin.profit-very-low,
        .sku-net-margin.profit-very-low {
            color: #f97316;
            font-weight: 600;
        }
        
        .sku-gross-margin.profit-negative,
        .sku-net-margin.profit-negative {
            color: var(--danger);
            font-weight: 600;
        }
        
        .sku-cost-margin.profit-high {
            color: #8b5cf6;
            font-weight: 600;
        }
        
        .sku-cost-margin.profit-medium {
            color: var(--success);
            font-weight: 600;
        }
        
        .sku-cost-margin.profit-low {
            color: var(--warning);
            font-weight: 600;
        }
        
        .sku-cost-margin.profit-very-low {
            color: #f97316;
            font-weight: 600;
        }
        
        .sku-cost-margin.profit-negative {
            color: var(--danger);
            font-weight: 600;
        }
        
        .sku-final-price.profit-positive {
            color: var(--primary);
            font-weight: 600;
        }
        
        /* æ¯”ç‡é¢œè‰² */
        .ratio-value.high {
            color: #8b5cf6;
        }
        
        .ratio-value.medium {
            color: var(--success);
        }
        
        .ratio-value.low {
            color: var(--warning);
        }
    </style>
</body>
</html>
